<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cocktail Card</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body class="cocktail-card">

  <div class="card">
    <h1 id="title">Loading...</h1>

    <div id="ingredients" class="card-section"></div>
    <div id="method" class="card-section"></div>
    <div id="glassware" class="card-section"></div>
    <div id="garnish" class="card-section"></div>
    <div id="pro_tip" class="card-section"></div>
    <div id="did_you_know" class="card-section"></div>
  </div>

  <footer class="footer-nav">
    <a href="../index.html">‚Üê Back to Main Page</a>
  </footer>

  <script>
    async function loadCocktail() {
      const urlParams = new URLSearchParams(window.location.search);
      const rawSlug = urlParams.get("slug");
      const decodedSlug = decodeURIComponent(rawSlug || "").toLowerCase();

      try {
        const res = await fetch("../data/cocktail_data_backup.json");
        const data = await res.json();

        // Match by simplified title (converted to slug form)
        const slugify = title => title.toLowerCase().replace(/[^\w\s]/g, '').replace(/\s+/g, '-');
        const cocktail = data.find(c => slugify(c.title) === decodedSlug);

        if (!cocktail) {
          document.body.innerHTML = "<p style='text-align: center;'>Cocktail not found.</p>";
          return;
        }

        document.getElementById("title").textContent = cocktail.title;

        const sections = [
          { id: "ingredients", label: "Ingredients", content: Array.isArray(cocktail.ingredients) ? cocktail.ingredients.join("<br>") : cocktail.ingredients },
          { id: "method", label: "Method", content: cocktail.method },
          { id: "glassware", label: "Glassware", content: cocktail.glassware },
          { id: "garnish", label: "Garnish", content: cocktail.garnish },
          { id: "pro_tip", label: "Pro Tip", content: cocktail.pro_tip },
          { id: "did_you_know", label: "Did You Know", content: cocktail.did_you_know }
        ];

        sections.forEach(({ id, label, content }) => {
          if (content) {
            const container = document.getElementById(id);
            container.innerHTML = `<h2>${label}</h2><p>${content}</p>`;
          }
        });

      } catch (error) {
        document.body.innerHTML = "<p style='text-align: center;'>Failed to load cocktail data.</p>";
      }
    }

    window.onload = loadCocktail;
  </script>
</body>
</html>